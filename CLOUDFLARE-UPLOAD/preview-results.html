<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results Preview - Hayden Claims Group</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            background: #0a0a0a;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .preview-container {
            max-width: 1000px;
            margin: 0 auto;
            background: #1a1a1a;
            border-radius: 12px;
            padding: 40px;
        }
        .preview-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #333;
        }
        .preview-header h1 {
            color: #FF6A13;
            font-size: 28px;
            margin-bottom: 10px;
        }
        .preview-header p {
            color: #999;
            font-size: 14px;
        }
        /* Override any hidden classes */
        #resultsPreview {
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        .results-container {
            opacity: 1 !important;
            animation: none !important;
        }
    </style>
</head>
<body>
    <div class="preview-container">
        <div class="preview-header">
            <h1>üé® Results Page Preview</h1>
            <p>Sample data from: req_1761011387946_7c6miprgl</p>
        </div>

        <!-- Results Display (visible, not hidden) -->
        <div id="resultsPreview" style="display: block; opacity: 1;"></div>
    </div>

    <script>
        // Sample data from the API
        const sampleData = {
            "analysis_complete": true,
            "property_address": "1112 Barbara Ann St., Kerrville, TX 78028",
            "overall_risk": "HIGH",
            "risk_score": 75,
            "hail_probability": 0.65,
            "wind_probability": 0.45,
            "flood_probability": 0.25,
            "report_date": "10/19/2025",
            "analysis_id": "HCG-1760902003937-XHCTCP",
            "request_id": "req_1761011387946_7c6miprgl",
            "pdf_url": "https://example.com/sample-report.pdf",
            "html_results": `
                <div style="font-family: Arial, sans-serif; padding: 20px; line-height: 1.6;">
                    <h2 style="color: #2c3e50; border-bottom: 3px solid #FF6A13; padding-bottom: 10px;">
                        Comprehensive Storm Damage Analysis
                    </h2>
                    <p style="color: #555; font-size: 16px;">
                        This is a sample HTML report that would be generated by your system. 
                        It will be displayed beautifully in the results page below all the summary information.
                    </p>
                    <h3 style="color: #34495e; margin-top: 25px;">Property Details</h3>
                    <ul style="color: #666;">
                        <li>Address: 1112 Barbara Ann St., Kerrville, TX 78028</li>
                        <li>Assessment Date: October 19, 2025</li>
                        <li>Analysis ID: HCG-1760902003937-XHCTCP</li>
                    </ul>
                    <h3 style="color: #34495e; margin-top: 25px;">Risk Assessment Summary</h3>
                    <p style="color: #666;">
                        Based on historical storm data, current weather patterns, and property characteristics,
                        this location shows elevated risk for hail damage. The analysis indicates a 65% probability
                        of significant hail events, with moderate wind risk (45%) and lower flood risk (25%).
                    </p>
                    <h3 style="color: #34495e; margin-top: 25px;">Recommended Actions</h3>
                    <ol style="color: #666;">
                        <li>Schedule professional roof inspection within 30 days</li>
                        <li>Document current property condition with photos</li>
                        <li>Review insurance coverage limits and deductibles</li>
                        <li>Consider impact-resistant roofing materials for future repairs</li>
                    </ol>
                    <div style="background: #f8f9fa; border-left: 4px solid #FF6A13; padding: 15px; margin-top: 25px;">
                        <strong style="color: #FF6A13;">Important Notice:</strong>
                        <p style="color: #666; margin: 10px 0 0 0;">
                            This analysis is based on available data and should be used as a guide. 
                            Contact Hayden Claims Group at (469) 434-2121 for a detailed inspection.
                        </p>
                    </div>
                </div>
            `
        };

        // Helper functions (copied from script.js)
        function getRiskClass(risk) {
            if (!risk) return 'medium';
            const r = risk.toString().toUpperCase();
            if (r === 'HIGH') return 'high';
            if (r === 'LOW') return 'low';
            return 'medium';
        }

        function getRiskLevel(score) {
            if (score >= 70) return 'HIGH';
            if (score >= 40) return 'MEDIUM';
            return 'LOW';
        }

        function getRiskLabelForPercent(percent) {
            if (percent >= 60) return 'High Risk';
            if (percent >= 30) return 'Moderate Risk';
            return 'Low Risk';
        }

        function createRiskCard(type, probability, icon) {
            const riskClass = probability >= 60 ? 'high' : probability >= 30 ? 'medium' : 'low';
            const riskLabel = getRiskLabelForPercent(probability);
            
            return `
                <div class="risk-card ${riskClass}">
                    <div class="risk-icon">${icon}</div>
                    <h4>${type} Risk</h4>
                    <div class="risk-percentage">${probability.toFixed(0)}%</div>
                    <div class="risk-bar">
                        <div class="risk-bar-fill" style="width: ${probability}%; animation: fillBar 1s ease-out;"></div>
                    </div>
                    <div class="risk-label">${riskLabel}</div>
                </div>
            `;
        }

        function generateRecommendations(hail, wind, flood, riskScore) {
            const recommendations = [];
            
            if (hail > 50) {
                recommendations.push({ icon: 'üè†', text: 'Consider impact-resistant roofing materials' });
            }
            if (wind > 40) {
                recommendations.push({ icon: 'üí®', text: 'Secure outdoor items and check roof attachments' });
            }
            if (flood > 30) {
                recommendations.push({ icon: 'üåä', text: 'Schedule a free property inspection' });
            }
            
            recommendations.push({ icon: 'üìã', text: 'Document current property condition' });
            
            if (riskScore > 60) {
                recommendations.push({ icon: '‚òéÔ∏è', text: 'Contact us for immediate assessment' });
            }
            
            return recommendations;
        }

        // Render the results
        function renderResults(data) {
            const parseProb = (val) => {
                if (!val) return 0;
                const num = typeof val === 'string' ? parseFloat(val) : val;
                return num > 1 ? num : num * 100;
            };
            
            const hailPercent = parseProb(data.hail_probability);
            const windPercent = parseProb(data.wind_probability);
            const floodPercent = parseProb(data.flood_probability);
            const riskScore = data.risk_score || Math.round((hailPercent + windPercent + floodPercent) / 3);
            const overallRisk = data.overall_risk || getRiskLevel(riskScore);
            
            return `
                <div class="results-container">
                    <!-- Header Section -->
                    <div class="results-header">
                        <h2>üå™Ô∏è Storm Risk Assessment Complete</h2>
                        <div class="completion-badge">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="12" r="10" stroke="#4CAF50" stroke-width="2"/>
                                <path d="M7 12l3 3 7-7" stroke="#4CAF50" stroke-width="2" fill="none"/>
                            </svg>
                            <span>Analysis Complete</span>
                        </div>
                    </div>

                    <!-- Property Info Card -->
                    <div class="info-card">
                        <div class="info-row">
                            <div class="info-item full-width">
                                <span class="info-label">üìç Property Address</span>
                                <span class="info-value address">${data.property_address || 'N/A'}</span>
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="info-item">
                                <span class="info-label">üìÖ Report Date</span>
                                <span class="info-value">${data.report_date || new Date().toLocaleDateString()}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">‚ö†Ô∏è Overall Risk Level</span>
                                <span class="info-value risk-badge ${getRiskClass(overallRisk)}">${overallRisk}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">üìä Risk Score</span>
                                <span class="info-value score">${riskScore}/100</span>
                            </div>
                        </div>
                    </div>

                    <!-- Risk Analysis Section -->
                    <div class="risk-analysis">
                        <h3>Storm Risk Breakdown</h3>
                        <div class="risk-grid">
                            ${createRiskCard('Hail', hailPercent, 'üå®Ô∏è')}
                            ${createRiskCard('Wind', windPercent, 'üí®')}
                            ${createRiskCard('Flood', floodPercent, 'üåä')}
                        </div>
                    </div>

                    <!-- Recommendations -->
                    <div class="recommendations">
                        <h3>Professional Recommendations</h3>
                        <div class="recommendation-list">
                            ${generateRecommendations(hailPercent, windPercent, floodPercent, riskScore).map(rec => `
                                <div class="recommendation-item">
                                    <span class="rec-icon">${rec.icon}</span>
                                    <span class="rec-text">${rec.text}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Full HTML Report Section -->
                    ${data.html_results ? `
                        <div class="full-report-section">
                            <h3>üìÑ Complete Analysis Report</h3>
                            <div class="report-frame">
                                ${data.html_results}
                            </div>
                        </div>
                    ` : ''}

                    <!-- Action Buttons -->
                    <div class="action-buttons-results">
                        ${data.pdf_url ? `
                            <a href="${data.pdf_url}" class="button primary" target="_blank">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Download PDF Report
                            </a>
                        ` : ''}
                        <button class="button secondary" onclick="return false;">New Assessment</button>
                    </div>
                </div>
            `;
        }

        // Render on page load
        document.addEventListener('DOMContentLoaded', () => {
            const previewDiv = document.getElementById('resultsPreview');
            previewDiv.innerHTML = renderResults(sampleData);
            // Ensure it's visible
            previewDiv.style.display = 'block';
            previewDiv.style.opacity = '1';
            console.log('Preview rendered successfully');
        });
    </script>
</body>
</html>
