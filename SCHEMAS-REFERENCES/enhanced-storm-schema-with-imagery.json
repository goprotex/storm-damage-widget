{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/goprotex/storm-damage-widget/main/enhanced-storm-schema-with-imagery.json",
  "title": "Hayden Claims Group - Enhanced Storm Schema with Imagery Intelligence",
  "description": "Complete JSON schema for storm data extraction with visual storm intelligence",
  "type": "object",
  "properties": {
    "property_coordinates": {
      "type": "object",
      "properties": {
        "latitude": {
          "type": "number",
          "minimum": -90,
          "maximum": 90,
          "description": "Property latitude in decimal degrees"
        },
        "longitude": {
          "type": "number", 
          "minimum": -180,
          "maximum": 180,
          "description": "Property longitude in decimal degrees"
        },
        "address_verified": {
          "type": "boolean",
          "description": "Whether the address coordinates were successfully verified"
        }
      },
      "required": ["latitude", "longitude", "address_verified"],
      "additionalProperties": false
    },
    "search_parameters": {
      "type": "object",
      "properties": {
        "radius_miles": {
          "type": "integer",
          "minimum": 1,
          "maximum": 50,
          "description": "Search radius in miles from property"
        },
        "total_pins_found": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of data pins found in search area"
        },
        "date_range": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2} to \\d{4}-\\d{2}-\\d{2}$",
          "description": "Date range of available data (YYYY-MM-DD to YYYY-MM-DD)"
        }
      },
      "required": ["radius_miles", "total_pins_found", "date_range"],
      "additionalProperties": false
    },
    "hail_events": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "description": "Event date in YYYY-MM-DD format"
          },
          "time": {
            "type": "string",
            "pattern": "^\\d{2}:\\d{2}$",
            "description": "Event time in HH:MM format if available"
          },
          "hail_size_inches": {
            "type": "number",
            "minimum": 0,
            "maximum": 10,
            "description": "Measured hail size in inches"
          },
          "distance_miles": {
            "type": "number",
            "minimum": 0,
            "maximum": 50,
            "description": "Distance from property in miles"
          },
          "direction": {
            "type": "string",
            "enum": ["N", "NE", "E", "SE", "S", "SW", "W", "NW"],
            "description": "Direction from property"
          },
          "vector_pin_id": {
            "type": "string",
            "description": "Unique identifier for the data source pin"
          },
          "additional_data": {
            "type": "string",
            "description": "Any additional measurements or notes"
          }
        },
        "required": ["date", "hail_size_inches", "distance_miles", "direction", "vector_pin_id"],
        "additionalProperties": false
      }
    },
    "wind_events": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "description": "Event date in YYYY-MM-DD format"
          },
          "time": {
            "type": "string",
            "pattern": "^\\d{2}:\\d{2}$",
            "description": "Event time in HH:MM format if available"
          },
          "wind_speed_mph": {
            "type": "number",
            "minimum": 0,
            "maximum": 300,
            "description": "Measured wind speed in mph"
          },
          "wind_type": {
            "type": "string",
            "enum": ["straight_line", "tornado", "microburst", "downburst", "other"],
            "description": "Type of wind event"
          },
          "distance_miles": {
            "type": "number",
            "minimum": 0,
            "maximum": 50,
            "description": "Distance from property in miles"
          },
          "direction": {
            "type": "string",
            "enum": ["N", "NE", "E", "SE", "S", "SW", "W", "NW"],
            "description": "Direction from property"
          },
          "vector_pin_id": {
            "type": "string",
            "description": "Unique identifier for the data source pin"
          },
          "additional_data": {
            "type": "string",
            "description": "Any additional measurements or notes"
          }
        },
        "required": ["date", "wind_speed_mph", "wind_type", "distance_miles", "direction", "vector_pin_id"],
        "additionalProperties": false
      }
    },
    "tornado_events": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "description": "Event date in YYYY-MM-DD format"
          },
          "time": {
            "type": "string",
            "pattern": "^\\d{2}:\\d{2}$",
            "description": "Event time in HH:MM format if available"
          },
          "ef_rating": {
            "type": "string",
            "enum": ["EF0", "EF1", "EF2", "EF3", "EF4", "EF5"],
            "description": "Enhanced Fujita Scale rating"
          },
          "path_width_yards": {
            "type": "number",
            "minimum": 0,
            "maximum": 5000,
            "description": "Tornado path width in yards if available"
          },
          "distance_miles": {
            "type": "number",
            "minimum": 0,
            "maximum": 50,
            "description": "Distance from property in miles"
          },
          "direction": {
            "type": "string",
            "enum": ["N", "NE", "E", "SE", "S", "SW", "W", "NW"],
            "description": "Direction from property"
          },
          "vector_pin_id": {
            "type": "string",
            "description": "Unique identifier for the data source pin"
          },
          "additional_data": {
            "type": "string",
            "description": "Path information or damage reports"
          }
        },
        "required": ["date", "ef_rating", "distance_miles", "direction", "vector_pin_id"],
        "additionalProperties": false
      }
    },
    "flood_events": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "description": "Event date in YYYY-MM-DD format"
          },
          "flood_type": {
            "type": "string",
            "enum": ["flash", "river", "urban", "coastal", "other"],
            "description": "Type of flooding event"
          },
          "severity": {
            "type": "string",
            "enum": ["minor", "moderate", "major", "record"],
            "description": "Flood severity level"
          },
          "distance_miles": {
            "type": "number",
            "minimum": 0,
            "maximum": 50,
            "description": "Distance from property in miles"
          },
          "direction": {
            "type": "string",
            "enum": ["N", "NE", "E", "SE", "S", "SW", "W", "NW"],
            "description": "Direction from property"
          },
          "vector_pin_id": {
            "type": "string",
            "description": "Unique identifier for the data source pin"
          },
          "additional_data": {
            "type": "string",
            "description": "Depth, duration, or damage reports"
          }
        },
        "required": ["date", "flood_type", "severity", "distance_miles", "direction", "vector_pin_id"],
        "additionalProperties": false
      }
    },
    "damage_reports": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "date": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "description": "Report date in YYYY-MM-DD format"
          },
          "report_type": {
            "type": "string",
            "enum": ["structural", "vehicle", "crop", "tree", "power", "other"],
            "description": "Type of damage reported"
          },
          "damage_description": {
            "type": "string",
            "maxLength": 500,
            "description": "Brief description of the damage"
          },
          "distance_miles": {
            "type": "number",
            "minimum": 0,
            "maximum": 50,
            "description": "Distance from property in miles"
          },
          "direction": {
            "type": "string",
            "enum": ["N", "NE", "E", "SE", "S", "SW", "W", "NW"],
            "description": "Direction from property"
          },
          "source": {
            "type": "string",
            "description": "Vector pin ID or reference source"
          }
        },
        "required": ["date", "report_type", "damage_description", "distance_miles", "direction", "source"],
        "additionalProperties": false
      }
    },
    "storm_imagery_intelligence": {
      "type": "object",
      "description": "Visual storm intelligence data from satellite, radar, and mapping sources",
      "properties": {
        "imagery_available": {
          "type": "boolean",
          "description": "Whether storm imagery was successfully collected"
        },
        "satellite_imagery": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["satellite", "infrared", "visible", "water_vapor"],
                "description": "Type of satellite imagery"
              },
              "source": {
                "type": "string",
                "enum": ["NOAA_GOES16", "NOAA_GOES17", "NOAA_GOES18", "WeatherAPI", "Google_Earth"],
                "description": "Source of satellite data"
              },
              "description": {
                "type": "string",
                "maxLength": 200,
                "description": "Description of the satellite image"
              },
              "url": {
                "type": "string",
                "format": "uri",
                "description": "URL to access the satellite image"
              },
              "thumbnail_url": {
                "type": "string",
                "format": "uri",
                "description": "URL to thumbnail version of image"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp when image was captured"
              },
              "coverage_area": {
                "type": "string",
                "description": "Geographic area covered by the image"
              },
              "resolution": {
                "type": "string",
                "enum": ["High", "Medium", "Low"],
                "description": "Image resolution quality"
              },
              "weather_insight": {
                "type": "string",
                "maxLength": 300,
                "description": "Meteorological analysis of the imagery"
              }
            },
            "required": ["type", "source", "description", "url", "timestamp"],
            "additionalProperties": false
          }
        },
        "radar_imagery": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["base_reflectivity", "velocity", "composite", "storm_relative"],
                "description": "Type of radar data"
              },
              "source": {
                "type": "string",
                "enum": ["NOAA_Weather_Radar", "WeatherAPI", "Commercial_Radar"],
                "description": "Source of radar data"
              },
              "description": {
                "type": "string",
                "maxLength": 200,
                "description": "Description of the radar image"
              },
              "url": {
                "type": "string",
                "format": "uri",
                "description": "URL to access the radar image"
              },
              "thumbnail_url": {
                "type": "string",
                "format": "uri",
                "description": "URL to thumbnail version of image"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp when radar data was captured"
              },
              "radar_site": {
                "type": "string",
                "description": "Identifier of the radar site"
              },
              "weather_insight": {
                "type": "string",
                "maxLength": 300,
                "description": "Analysis of radar patterns and storm features"
              }
            },
            "required": ["type", "source", "description", "url", "timestamp"],
            "additionalProperties": false
          }
        },
        "storm_tracks": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["storm_track", "tornado_path", "hail_swath", "wind_damage_path"],
                "description": "Type of storm tracking data"
              },
              "description": {
                "type": "string",
                "maxLength": 200,
                "description": "Description of the storm track"
              },
              "map_url": {
                "type": "string",
                "format": "uri",
                "description": "URL to interactive map showing storm track"
              },
              "static_image_url": {
                "type": "string",
                "format": "uri",
                "description": "URL to static image of storm track"
              },
              "path_coordinates": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "latitude": { "type": "number" },
                    "longitude": { "type": "number" },
                    "timestamp": { "type": "string", "format": "date-time" }
                  },
                  "required": ["latitude", "longitude"]
                },
                "description": "Coordinate points along the storm path"
              },
              "closest_approach_distance": {
                "type": "number",
                "minimum": 0,
                "description": "Closest distance of storm track to property in miles"
              },
              "storm_intensity": {
                "type": "string",
                "description": "Peak intensity during closest approach"
              }
            },
            "required": ["type", "description"],
            "additionalProperties": false
          }
        },
        "damage_examples": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["similar_property", "regional_damage", "storm_survey", "insurance_photo"],
                "description": "Type of damage example"
              },
              "description": {
                "type": "string",
                "maxLength": 200,
                "description": "Description of the damage example"
              },
              "image_url": {
                "type": "string",
                "format": "uri",
                "description": "URL to damage example image"
              },
              "source": {
                "type": "string",
                "description": "Source of the damage example"
              },
              "storm_correlation": {
                "type": "string",
                "maxLength": 300,
                "description": "How this damage relates to the current property's risk"
              },
              "distance_from_property": {
                "type": "number",
                "minimum": 0,
                "description": "Distance from current property in miles"
              }
            },
            "required": ["type", "description", "image_url", "source"],
            "additionalProperties": false
          }
        },
        "featured_images": {
          "type": "object",
          "description": "Key images selected for widget carousel and PDF reports",
          "properties": {
            "widget_carousel": {
              "type": "array",
              "maxItems": 5,
              "items": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": ["satellite", "radar", "storm_track", "damage_example"],
                    "description": "Type of image for carousel"
                  },
                  "description": {
                    "type": "string",
                    "maxLength": 100,
                    "description": "Short description for carousel display"
                  },
                  "thumbnail_url": {
                    "type": "string",
                    "format": "uri",
                    "description": "Thumbnail image URL for carousel"
                  },
                  "full_image_url": {
                    "type": "string",
                    "format": "uri",
                    "description": "Full resolution image URL"
                  },
                  "metadata": {
                    "type": "object",
                    "properties": {
                      "timestamp": { "type": "string" },
                      "source": { "type": "string" },
                      "resolution": { "type": "string" }
                    }
                  }
                },
                "required": ["type", "description", "thumbnail_url"],
                "additionalProperties": false
              }
            },
            "primary_satellite": {
              "type": "object",
              "description": "Primary satellite image for PDF reports",
              "properties": {
                "type": { "type": "string" },
                "description": { "type": "string" },
                "url": { "type": "string", "format": "uri" }
              }
            },
            "best_storm_track": {
              "type": "object", 
              "description": "Best storm track visualization for reports",
              "properties": {
                "type": { "type": "string" },
                "description": { "type": "string" },
                "url": { "type": "string", "format": "uri" }
              }
            },
            "top_damage_example": {
              "type": "object",
              "description": "Most relevant damage example for reports",
              "properties": {
                "type": { "type": "string" },
                "description": { "type": "string" },
                "url": { "type": "string", "format": "uri" }
              }
            }
          },
          "additionalProperties": false
        },
        "api_usage_metadata": {
          "type": "object",
          "description": "Tracking information for API usage and costs",
          "properties": {
            "apis_used": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["NOAA_Weather", "NOAA_Satellite", "WeatherAPI", "Google_Maps", "OpenAI"]
              }
            },
            "total_api_calls": {
              "type": "integer",
              "minimum": 0,
              "description": "Total number of API calls made"
            },
            "estimated_cost": {
              "type": "number",
              "minimum": 0,
              "description": "Estimated cost in USD for API usage"
            },
            "processing_time_seconds": {
              "type": "number",
              "minimum": 0,
              "description": "Total processing time for imagery collection"
            }
          }
        }
      },
      "required": ["imagery_available"],
      "additionalProperties": false
    },
    "data_summary": {
      "type": "object",
      "properties": {
        "total_events_found": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of storm events found"
        },
        "closest_event_distance": {
          "type": "number",
          "minimum": 0,
          "maximum": 50,
          "description": "Distance to closest storm event in miles"
        },
        "most_recent_event": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "Date of most recent storm event"
        },
        "most_severe_event": {
          "type": "string",
          "maxLength": 200,
          "description": "Description of most severe event found"
        },
        "data_completeness": {
          "type": "string",
          "enum": ["High", "Medium", "Low"],
          "description": "Assessment of data completeness based on pin density"
        },
        "imagery_enhancement": {
          "type": "boolean",
          "description": "Whether analysis was enhanced with storm imagery intelligence"
        }
      },
      "required": ["total_events_found", "data_completeness", "imagery_enhancement"],
      "additionalProperties": false
    }
  },
  "required": [
    "property_coordinates",
    "search_parameters", 
    "hail_events",
    "wind_events",
    "tornado_events",
    "flood_events",
    "damage_reports",
    "storm_imagery_intelligence",
    "data_summary"
  ],
  "additionalProperties": false
}